version: '3.4'
services:
  jenkins-dind:
    image: "redpandaci/jenkins-dind"
    ports: 
      - "8080"
    volumes:
      - jpl-dind-cache:/var/lib/docker
      - ./:/tmp/jpl-source
    privileged: true
    network_mode: bridge
  jenkins-agent1:
    image: "jenkins/jnlp-slave"
    entrypoint: ""
    command: 'bash -c "tail -f /var/log/*.log"'
    network_mode: bridge
  jenkins-agent2:
    image: "jenkins/jnlp-slave"
    entrypoint: ""
    command: 'bash -c "tail -f /var/log/*.log"'
    network_mode: bridge
volumes:
  jpl-dind-cache:
    external: true
